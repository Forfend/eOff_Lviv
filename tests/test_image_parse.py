import cv2
from src.image_parse import create_schedule
import json

SCHEDULE = {
    "1.1": {
        "0-1": "on",
        "1-2": "on",
        "2-3": "on",
        "3-4": "on",
        "4-5": "on",
        "5-6": "on",
        "6-7": "on",
        "7-8": "on",
        "8-9": "on",
        "9-10": "on",
        "10-11": "on",
        "11-12": "on",
        "12-13": "on",
        "13-14": "on",
        "14-15": "on",
        "15-16": "on",
        "16-17": "on",
        "17-18": "on",
        "18-19": "on",
        "19-20": "on",
        "20-21": "on",
        "21-22": "off",
        "22-23": "off",
        "23-0": "off"
    },
    "1.2": {
        "0-1": "on",
        "1-2": "on",
        "2-3": "on",
        "3-4": "on",
        "4-5": "on",
        "5-6": "on",
        "6-7": "on",
        "7-8": "on",
        "8-9": "on",
        "9-10": "on",
        "10-11": "on",
        "11-12": "on",
        "12-13": "on",
        "13-14": "on",
        "14-15": "on",
        "15-16": "on",
        "16-17": "on",
        "17-18": "on",
        "18-19": "on",
        "19-20": "on",
        "20-21": "on",
        "21-22": "off",
        "22-23": "off",
        "23-0": "off"
    },
    "2.1": {
        "0-1": "on",
        "1-2": "on",
        "2-3": "on",
        "3-4": "on",
        "4-5": "on",
        "5-6": "on",
        "6-7": "on",
        "7-8": "on",
        "8-9": "on",
        "9-10": "on",
        "10-11": "on",
        "11-12": "on",
        "12-13": "on",
        "13-14": "on",
        "14-15": "on",
        "15-16": "on",
        "16-17": "on",
        "17-18": "on",
        "18-19": "off",
        "19-20": "off",
        "20-21": "off",
        "21-22": "on",
        "22-23": "on",
        "23-0": "off"
    },
    "2.2": {
        "0-1": "on",
        "1-2": "on",
        "2-3": "on",
        "3-4": "on",
        "4-5": "on",
        "5-6": "on",
        "6-7": "on",
        "7-8": "on",
        "8-9": "on",
        "9-10": "on",
        "10-11": "on",
        "11-12": "on",
        "12-13": "on",
        "13-14": "on",
        "14-15": "on",
        "15-16": "on",
        "16-17": "on",
        "17-18": "on",
        "18-19": "off",
        "19-20": "off",
        "20-21": "off",
        "21-22": "on",
        "22-23": "on",
        "23-0": "off"
    },
    "3.1": {
        "0-1": "on",
        "1-2": "on",
        "2-3": "on",
        "3-4": "on",
        "4-5": "on",
        "5-6": "on",
        "6-7": "on",
        "7-8": "on",
        "8-9": "on",
        "9-10": "on",
        "10-11": "on",
        "11-12": "on",
        "12-13": "on",
        "13-14": "on",
        "14-15": "on",
        "15-16": "on",
        "16-17": "on",
        "17-18": "on",
        "18-19": "on",
        "19-20": "off",
        "20-21": "off",
        "21-22": "off",
        "22-23": "off",
        "23-0": "on"
    },
    "3.2": {
        "0-1": "on",
        "1-2": "on",
        "2-3": "on",
        "3-4": "on",
        "4-5": "on",
        "5-6": "on",
        "6-7": "on",
        "7-8": "on",
        "8-9": "on",
        "9-10": "on",
        "10-11": "on",
        "11-12": "on",
        "12-13": "on",
        "13-14": "on",
        "14-15": "on",
        "15-16": "on",
        "16-17": "on",
        "17-18": "on",
        "18-19": "on",
        "19-20": "off",
        "20-21": "off",
        "21-22": "off",
        "22-23": "off",
        "23-0": "on"
    }
}

def test_create_schedule():
    image = cv2.imread('assets/image6.png')
    image = cv2.imencode('.png', image)[1].tobytes()

    actual_schedule = create_schedule(image)
    
    assert json.loads(actual_schedule) == SCHEDULE